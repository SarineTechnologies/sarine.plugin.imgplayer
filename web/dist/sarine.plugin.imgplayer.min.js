!function(v){v.imgplay=function(t,n){var a={startImage:0,totalImages:null,imageName:null,urlDir:null,rate:null,height:null,width:null,autoPlay:!0},i=v(t),s=null,r=null,o=!1,m="forward",h=0,f=0,l=null,e=0,g=0,p=this;p.settings={},p.frames=[],p.init=function(){var t;p.settings=v.extend({},a,n),Object.keys(p.settings).map(function(t,e){null===p.settings[t]&&console.error("Sarine imageplayer error: "+t+" is undefined in plugin configuration")}),-1===p.settings.urlDir.indexOf("{num}")&&console.error("Sarine imageplayer error: urlDir should contain {num} string in the image name, like: Image_{num}.jpg"),h=p.settings.totalImages;for(var e=p.settings.startImage;e<p.settings.totalImages+p.settings.startImage;++e)t='<img class="imageplay_loaded" src="'+p.settings.urlDir.replace("{num}",e)+'" />',i.append(t),p.frames[e++]=v(t).get(0);i.addClass("sarine_imgplay"),i.css({height:n.height,width:n.width}),(s=v('<canvas class="imgplay-canvas">')).prop({height:n.height,width:n.width}),r=s.get(0).getContext("2d"),i.append(s),u(),i.find("img.imageplay_loaded").detach(),p.settings.rate||(p.settings.rate=parseInt(p.frames.length/10)),p.settings.rate=p.settings.rate<.001?.001:p.settings.rate,p.settings.rate=100<p.settings.rate?100:p.settings.rate,p.settings.autoPlay?p.play():setTimeout(function(){p.toFrame(p.settings.startImage)},500)},p.play=function(){o=!0,null!=l&&clearTimeout(l),c(),i.trigger("play")},p.pause=function(){o=!1,null!=l&&clearTimeout(l),i.trigger("pause")},p.stop=function(){o=!1,f=0,p.play(),i.trigger("stop",p)},p.toFrame=function(t){if(t=t<0?0:t,p.frames[t])return f=t,c(),v.Deferred().resolve()};var u=function(){var o=v('<div class="imgplay-progress" id="imgplay_move">'),t=v('<div class="imgplay-play-bar">');function l(t,e){return(e.originalEvent&&e.originalEvent.touches?(e.originalEvent&&e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]).pageX:e.pageX)-t.offset().left}var g=!1,u=-1;mousePosOnMouseDown=-1,curPosX=0,prevPosX=0,isRightDirection=!1,o.on("mousedown touchstart",function(t){var e;t.preventDefault(),e=t,p.pause(),g=!0,mousePosOnMouseDown=l(o,e),u=f}).on("mousemove touchmove",function(t){t.preventDefault(),function(t){if(g){var e=o,n=l(e,t),a=e.width();Math.floor(n/a*h),isRightDirection=n>=prevPosX,m=isRightDirection?"forward":"backward";var i,s=Math.floor(h/a*mousePosOnMouseDown),r=Math.floor(h/a*n);r>=mousePosOnMouseDown?(i=Math.floor(r-s),f=u+i):(i=Math.floor(s-r),f=u-i),h<f?f-=h:f<1&&(f=h+f),p.toFrame(f),prevPosX=n}}(t)}).on("mouseleave mouseup touchend",function(t){p.play(),g=!1}),o.append(t),i.append(o)},c=function(){if(null!=r){var t=p.frames[f],e=v(t);if(t&&0<e.prop("naturalHeight")&&(r.clearRect(0,0,n.width,n.height),r.drawImage(t,0,0,n.width,n.height)),f>p.frames.length)return void p.stop();o&&("forward"==m?f++:--f<0&&(f=p.frames.length+f),l=setTimeout(c,Math.ceil(1e3/p.settings.rate))),d()}},d=function(){e=p.frames.length/h*100,g=f/p.frames.length*100,e=100<e?100:e,g=100<g?100:g,i.find(".imgplay-play-bar").css("width",g+"%")};p.init()},v.fn.imgplay=function(e){return this.each(function(){if(null==v(this).data("imgplay")){var t=new v.imgplay(this,e);v(this).data("imgplay",t)}}),this}}(jQuery);
//# sourceMappingURL=sarine.plugin.imgplayer.min.js.map
